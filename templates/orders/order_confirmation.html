{% extends "base.html" %}

{% block title %}Order Confirmed — Ashen Emporium{% endblock %}

{% block content %}
<h1>Order Confirmed</h1>

<p class="muted">
  Thank you. Your order has been recorded.
</p>

<div class="card">
  <h2>Order #{{ order.id }}</h2>
  <p class="muted">Status: <strong>{{ order.get_status_display }}</strong></p>


  <ul>
  {% for item in order.items.all %}
    <li>
      {{ item.product_name }} × {{ item.qty }}
      <span class="muted">({{ item.line_total_gbp }})</span>
    </li>
  {% endfor %}
</ul>


    <div class="divider"></div>

  <p class="price-lg">{{ order.total_gbp }}</p>

 {% if order.status == "placed" %}
  {% if order.stripe_session_url %}
    <a class="cta-button" href="{% url 'start_checkout' order.id %}">Continue payment</a>
    <p class="muted" style="margin-top: .75rem;">
      If you see a Stripe “session complete” screen, <a href="{% url 'start_checkout' order.id %}?reset=1">start a new payment session</a>.
    </p>
  {% else %}
    <a class="cta-button" href="{% url 'start_checkout' order.id %}">Pay with Stripe</a>
  {% endif %}
  <p class="muted" style="margin-top: .75rem;">
    Your payment will be confirmed via Stripe webhook.
  </p>
{% elif order.status == "paid" %}
  <p class="muted">Payment confirmed. Your order is complete.</p>
{% else %}
  <p class="muted">This order is not payable ({{ order.get_status_display }}).</p>
{% endif %}


</div>


<a href="{% url 'product_list' %}" class="cta-button">
  Continue Shopping
</a>
{% endblock %}
