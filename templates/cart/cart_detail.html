{% extends "base.html" %}

{% load static image_helpers %}

{% block title %}Basket â€” Ashen Emporium{% endblock %}

{% block content %}
<h1>Your Basket</h1>

{% if items %}
  <div class="card">
    <div class="table-wrap">
    <table class="cart-table">
      <thead>
        <tr class="mb-1 muted">
          <th>Item</th>
          <th>Price</th>
          <th>Qty</th>
          <th>Line Total</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {% for item in items %}
        <tr>
          <td>
            <div class="cart-item">
              <img class="cart-thumb"
     src="{{ item.product.primary_image|image_or_placeholder }}"
     alt="{{ item.product.name }}">

              <a href="{{ item.product.get_absolute_url }}">{{ item.product.name }}</a>
            </div>
          </td>
          <td class="mb-1 muted">{{ item.line_total_gbp }}</td>
          <td>
            <form method="post" action="{% url 'cart_update' item.product.id %}" class="qty-form">
              {% csrf_token %}
              <input type="number" name="qty" min="0" value="{{ item.qty }}">
              <button type="submit" class="link-button">Update</button>
            </form>
          </td>
          <td class="mb-1 muted">{{ item.line_total_gbp }}</td>

          <td>
            <form method="post" action="{% url 'cart_remove' item.product.id %}">
              {% csrf_token %}
              <button type="submit" class="link-button">Remove</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    </div>
  </div>

  <div class="cart-summary">
  <div class="card">
    <h2>Total</h2>

    <p class="price-lg">{{ total_gbp }}</p>

    <a href="{% url 'checkout' %}" class="cta-button">
      Proceed to Checkout
    </a>

    <p class="muted">Placeholder text</p>
  </div>
</div>

{% else %}
  <p class="muted">Your basket is empty.</p>
  <a class="cta-button" href="{% url 'product_list' %}">Browse catalogue</a>
{% endif %}
{% endblock %}
